import{a as m,r as o,b as g,K as a,j as e,G as v}from"./index-DObBNmzj.js";function p(){const d=m(),[t,c]=o.useState([]),[l,u]=o.useState(!0),{user:r}=g(s=>s.userReducer);return o.useEffect(()=>(a.emit("getConversations",{}),a.on("conversationsList",s=>{c(s.conversations),u(!1)}),a.on("updatedConversation",s=>{c(n=>n.map(i=>i._id.toString()===s._id.toString()?{...i,unreadCounts:s.unreadCounts,lastMessage:s.lastMessage}:i))}),()=>{a.off("conversationsList"),a.off("updatedConversation")}),[]),e.jsxs("div",{className:"conversations-page",children:[e.jsxs("div",{className:"conversations-header",children:[e.jsx(v,{className:"arrow-left",size:32,style:{cursor:"pointer"},onClick:()=>d(-1)}),e.jsx("h2",{children:"Chats"})]}),!l&&t.length===0&&e.jsx("div",{className:"no-conversations",children:"No conversations yet."}),t.length>0&&e.jsx("div",{className:"conversations-list",children:t.map(s=>(s.participants.find(n=>String(n._id)!==String(r?.userId?._id)),e.jsxs("div",{className:"conversation-item",onClick:()=>d(`/chat/${s?.otherParticipantId}`),children:[e.jsx("img",{src:s?.otherParticipantData?.avatarUrl||"/default-avatar.png",alt:s?.otherParticipantData?.displayName||"User",className:"conversation-avatar"}),e.jsxs("div",{className:"conversation-info",children:[e.jsx("div",{className:"conversation-name",children:s?.otherParticipantData?.displayName||"User"}),e.jsx("div",{className:"conversation-lastmsg",children:s.lastMessage||e.jsx("em",{children:"No messages yet"})})]}),s.unreadCounts[String(r.userId._id)]>0&&e.jsx("div",{className:"unread-badge",children:s.unreadCounts[String(r.userId._id)]})]},s._id)))})]})}export{p as default};
