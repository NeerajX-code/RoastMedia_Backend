import{u as d,a as u,b as h,j as e,N as j,H as p,c as g,M as _,d as f,S as v,e as N,B as k,f as C,r as w,g as c,L as b,E as y}from"./index-BBlMiJUd.js";import{u as D}from"./useToast-XQdV5Y45.js";const P=({post:s})=>{const a=d(),n=u(),{user:i,profileLoading:r}=h(t=>t.userReducer),o=i?.userId?._id===s?.userData?._id,{toast:l}=D();return e.jsxs("div",{className:"post",children:[e.jsx(j,{to:`${o?"/Profile":`/other/profile/${s?.userData?._id}`}`,children:e.jsxs("div",{className:"post_top",children:[e.jsx("div",{className:"post_top_userImg",children:e.jsx("img",{src:s.profileData?.avatarUrl,alt:""})}),e.jsxs("div",{className:"post_top_userDetails",children:[e.jsxs("div",{className:"userDetails_left",children:[e.jsx("h2",{children:s.profileData?.displayName}),e.jsxs("p",{children:["@",s.userData?.username]})]}),e.jsx("div",{className:"userDetails_right",children:e.jsx("p",{children:new Intl.DateTimeFormat("en-US",{day:"2-digit",month:"short",year:"numeric"}).format(new Date(s.createdAt))})})]})]})}),e.jsx("div",{className:"post__image",children:e.jsx("img",{src:s.image,alt:""})}),e.jsxs("div",{className:"post__content",children:[e.jsx("h2",{className:"post__username",children:s.username}),e.jsx("p",{className:"post__caption",children:s.caption.replace(/[*"]+/g,"")}),e.jsxs("div",{className:"post__actions",children:[e.jsxs("button",{onClick:()=>{if(!i){l.error("Please login to like posts.");return}a(g(s._id))},children:[e.jsx(p,{stroke:s.isLiked?"none":"white",fill:s.isLiked?"red":"none"}),e.jsx("span",{children:s.likesCount})]}),e.jsxs("button",{onClick:()=>{if(!i){l.error("Please login to comment.");return}a(f(s._id)),n(`/Comments/${s._id}`)},children:[e.jsx(_,{})," ",e.jsx("span",{children:s.commentCount})]}),e.jsxs("button",{onClick:async()=>{a(N(s._id));const t=`${window.location.origin}/Single-post/${s._id}`,m=`
                            <a href="${t}" target="_blank">
                            <strong>Check this Post!</strong><br/>
                            <img src={${s.image}} width="200"/>
                            <p>{${s.caption.replace(/[*"]+/g,"")}}</p>
                            </a>`;try{await navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([t],{type:"text/plain"}),"text/html":new Blob([m],{type:"text/html"})})]),alert("Rich content copied to clipboard!")}catch(x){console.error("Failed:",x)}},children:[e.jsx(v,{})," ",e.jsx("span",{children:s.shareCount})]}),e.jsx("button",{onClick:()=>{if(!i){l.error("Please login to save posts.");return}a(C(s._id))},children:e.jsx(k,{stroke:s?.saved?"none":"white",fill:s?.saved?"white":"none"})})]})]})]})},S=()=>{const{posts:s,loading:a,error:n}=h(r=>r.HomePostReducer),i=d();return w.useEffect(()=>{s.length==0&&i(c())},[s,i]),a?e.jsx(b,{}):e.jsx("div",{className:"post-feed",style:{position:"relative"},children:e.jsxs("div",{className:"post-feed_wrapper",children:[e.jsxs("div",{className:"post-feed_options",children:[e.jsx("h2",{children:"For You"}),e.jsx("h2",{children:"Following"})]}),e.jsx(y,{message:n,loading:a,action:c}),e.jsx("div",{className:"post-feed__list",children:s?.map((r,o)=>e.jsx(P,{post:r},o))})]})})};export{S as default};
